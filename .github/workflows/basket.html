<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</title>
    <style>
    @import url('https://fonts.googleapis.com/css2?family=Prompt&display=swap');

    /* CSS ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì */
    body {
        margin: 0;
        font-family: 'Prompt', sans-serif;
        background: #f3f4f6;
        color: #1f2937;
    }

    header {
        background: #1e40af;
        color: #fff;
        padding: 16px 32px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    header a {
        color: #fff;
        text-decoration: none;
        margin-left: 20px;
        font-weight: bold;
    }

    .logo {
        font-size: 1.8rem;
        font-weight: bold;
    }

    .container {
        max-width: 1200px;
        margin: 40px auto;
        padding: 0 20px;
    }

    h1 {
        text-align: center;
        margin-bottom: 40px;
        color: #1e40af;
    }

    .cart-table {
        width: 100%;
        border-collapse: collapse;
        background: #fff;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .cart-table th, .cart-table td {
        padding: 15px;
        text-align: center;
    }

    .cart-table th {
        background: #2563eb;
        color: #fff;
    }

    .cart-table td img {
        width: 80px;
        height: 80px;
        border-radius: 8px;
    }

    .quantity-input {
        width: 50px;
        text-align: center;
        padding: 5px;
        border-radius: 6px;
        border: 1px solid #ccc;
    }

    .remove-btn {
        background: #ef4444;
        color: #fff;
        border: none;
        padding: 6px 12px;
        border-radius: 6px;
        cursor: pointer;
    }

    .remove-btn:hover {
        background: #dc2626;
    }

    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î */
    .clear-cart-btn {
        background: #9ca3af;
        color: #fff;
        padding: 12px 28px;
        border-radius: 6px;
        font-weight: bold;
        border: none;
        cursor: pointer;
        float: left; /* ‡∏à‡∏±‡∏î‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢ */
        margin-top: 20px;
        transition: background 0.3s;
    }
    .clear-cart-btn:hover {
        background: #6b7280;
    }
    
    .total {
        text-align: right;
        margin-top: 20px;
        font-size: 1.5rem;
        font-weight: bold;
    }

    .checkout-btn {
        background: #facc15;
        color: #1e40af;
        padding: 12px 28px;
        border-radius: 6px;
        font-weight: bold;
        border: none;
        cursor: pointer;
        display: block; 
        width: fit-content; 
        margin-left: auto; 
        margin-top: 20px;
        transition: background 0.3s;
    }

    .checkout-btn:hover {
        background: #fbbf24;
    }

    @media (max-width: 768px) {
        .cart-table th, .cart-table td {
            font-size: 14px;
            padding: 10px;
        }
        .quantity-input {
            width: 40px;
        }
    }
    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Popup (Modal) */
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.4);
    }

    .modal-content {
        background-color: #fefefe;
        margin: 15% auto;
        padding: 30px;
        border: 1px solid #888;
        width: 80%;
        max-width: 400px;
        text-align: center;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }

    .close-btn {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close-btn:hover,
    .close-btn:focus {
        color: #000;
        text-decoration: none;
        cursor: pointer;
    }
    .success-icon {
        color: #10b981;
        font-size: 50px;
        margin-bottom: 15px;
    }
    .empty-cart {
        text-align: center;
        padding: 50px;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        color: #ef4444;
        font-weight: bold;
        font-size: 1.2rem;
    }

    </style>
</head>
<body>
<header>
    <div class="logo">‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</div>
    <nav>
        <a href="Home.html">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        <a href="Start.html" class="btn-primary">‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô</a>
    </nav>
</header>

<div class="container">
    <h1>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1>
    <table class="cart-table" id="cart-table">
        <thead>
            <tr>
                <th>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                <th>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                <th>‡∏£‡∏≤‡∏Ñ‡∏≤</th>
                <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                <th>‡∏£‡∏ß‡∏°</th>
                <th>‡∏•‡∏ö</th>
            </tr>
        </thead>
        <tbody id="cart-items">
            </tbody>
    </table>
    
    <div class="empty-cart" id="empty-message" style="display:none;">
        üõí ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
    </div>

    <button class="clear-cart-btn" onclick="clearCart()">‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>

    <div class="total">
        ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°: <span id="grand-total">‡∏ø0</span>
    </div>
    
    <button class="checkout-btn" onclick="placeOrder()">‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ / ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
</div>

<div id="successModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal()">&times;</span>
        <div class="success-icon">‚úÖ</div>
        <h2>‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h2>
        <p>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
        <p>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏ä‡∏≥‡∏£‡∏∞: <strong id="paid-total">‡∏ø0</strong></p>
        <button class="remove-btn" onclick="closeModal()" style="margin-top: 15px; background: #2563eb;">‡∏õ‡∏¥‡∏î</button>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', loadCart);

    // 1. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å: ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Local Storage ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á
    function loadCart() {
        // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Local Storage
        const cart = JSON.parse(localStorage.getItem('cartItems')) || [];
        const cartItemsBody = document.getElementById('cart-items');
        const emptyMessage = document.getElementById('empty-message');
        const checkoutBtn = document.querySelector('.checkout-btn');
        const clearBtn = document.querySelector('.clear-cart-btn'); // ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ñ‡∏∂‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏•‡πâ‡∏≤‡∏á

        cartItemsBody.innerHTML = ''; // ‡∏•‡πâ‡∏≤‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏Å‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô

        if (cart.length === 0) {
            emptyMessage.style.display = 'block';
            checkoutBtn.style.display = 'none';
            clearBtn.style.display = 'none'; // ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏•‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á
        } else {
            emptyMessage.style.display = 'none';
            checkoutBtn.style.display = 'block';
            clearBtn.style.display = 'block'; // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏•‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤

            cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                const row = document.createElement('tr');
                row.setAttribute('data-index', index); 
                
                row.innerHTML = `
                    <td><img src="${item.image}" alt="${item.name}"></td>
                    <td class="product-name">${item.name}</td>
                    <td class="item-price">‡∏ø${item.price.toLocaleString('th-TH')}</td>
                    <td><input type="number" class="quantity-input" value="${item.quantity}" min="1" onchange="updateQuantity(${index}, this.value)"></td>
                    <td class="item-total">‡∏ø${itemTotal.toLocaleString('th-TH')}</td>
                    <td><button class="remove-btn" onclick="removeItem(${index})">‡∏•‡∏ö</button></td>
                `;
                cartItemsBody.appendChild(row);
            });
        }
        calculateGrandTotal(cart);
    }
    
    // 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô input)
    function updateQuantity(index, newQuantity) {
        let cart = JSON.parse(localStorage.getItem('cartItems')) || [];
        const quantity = parseInt(newQuantity);
        
        if (quantity <= 0) {
            removeItem(index);
            return;
        }
        
        if (cart[index]) {
            cart[index].quantity = quantity;
            localStorage.setItem('cartItems', JSON.stringify(cart));
            loadCart(); 
        }
    }

    // 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏ó‡∏µ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
    function removeItem(index) {
        let cart = JSON.parse(localStorage.getItem('cartItems')) || [];
        
        if (cart[index]) {
            const productName = cart[index].name;
            if (confirm(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö "${productName}" ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
                cart.splice(index, 1); 
                localStorage.setItem('cartItems', JSON.stringify(cart));
                loadCart(); 
            }
        }
    }

    // 4. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    function calculateGrandTotal(cart) {
        let grandTotal = 0;
        
        if (cart.length > 0) {
            grandTotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
        }

        document.getElementById('grand-total').textContent = `‡∏ø${grandTotal.toLocaleString('th-TH')}`;
    }

    // 5. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏´‡∏°‡πà: ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    function clearCart() {
        if (confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤?")) {
            localStorage.removeItem('cartItems'); // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            loadCart(); // ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà (‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤)
        }
    }


    // 6. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (Place Order)
    function placeOrder() {
        const cart = JSON.parse(localStorage.getItem('cartItems')) || [];
        
        if (cart.length === 0) {
            alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏•‡∏á‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠');
            return; 
        }

        const finalTotal = document.getElementById('grand-total').textContent;
        
        document.getElementById('paid-total').textContent = finalTotal;

        document.getElementById('successModal').style.display = 'block';
        
        localStorage.removeItem('cartItems');
        loadCart();
    }

    // 7. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏¥‡∏î Popup
    function closeModal() {
        document.getElementById('successModal').style.display = 'none';
    }

    // ‡∏õ‡∏¥‡∏î Modal ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ô‡∏≠‡∏Å Modal
    window.onclick = function(event) {
        const modal = document.getElementById('successModal');
        if (event.target == modal) {
            closeModal();
        }
    }
</script>
</body>
</html>
